# DEV.md

## 概要
- イラスト模写支援アプリケーションの設計
- ブラウザで動作するWebアプリケーション
- 画面を左右に分割し、以下のような機能をそれぞれ提供する：
	- イラストを読み込み、お手本として表示する（左）
	- 簡単なドローイング機能を提供し、模写練習ができる（右）

## 機能要件
### お手本画面
- お手本画像は保存できる
	- 後から開き直すこともできるようにする
	- ファイルの実体はWebアプリケーションが起動しているサーバのローカルに保存する
	- 既に保存済みのお手本画像を読み込もうとした場合、警告を表示してから既存のお手本を読み込む
- お手本にはグリッドをオーバーレイできる
	- グリッドの縦横間隔、グリッド線の太さなどは簡単に変更できる
- お手本画面では点と点の長さを測定したり、線と線の角度を測定できる
	- 測定結果は永続化し、お手本を読み込んだ時に復元できる
### ドローイング画面
- ペンの太さを変更できる
	- px単位で指定する
	- 最初は固定値でよい
- ペンの色を変更できる
	- カラーピッカーで色を選択できる
	- 最初は黒のみでよい
- 描いた絵は保存できる
	- お手本のIDと紐付ける。お手本を読み込むと描いた絵が一覧できる
### 共通
- ドローイング画面で描いた絵にお手本を重ねて、ずれを可視化できる
- 左右両方の画面をそれぞれ左右反転して、歪みを確認できる

## 技術要件
- Viteサーバ + ReactのシンプルなWebアプリとする
- 永続化が必要なデータにはSQLiteを用いる
- テストフレームワークとしてVitestを使用する

## Logs

### 2025/6/16 - プロジェクト確認
- リポジトリ内容を確認
- 現在の状態：初期Vite+Reactテンプレート
- 設計仕様をDEV.mdで確認完了

#### MVP構成要素の考察
**必須機能（Core MVP）**
- お手本画像のアップロード・表示
- 基本的な固定間隔グリッドオーバーレイ
- Canvas要素での基本描画機能
- ペンの太さ調整（3-4段階）
- 描画クリア機能
- 左右分割レイアウト

**重要だが後回し可能**
- 描画データ永続化
- お手本画像保存
- 測定機能
- 重ね合わせ機能
- 左右反転
- カラーピッカー

**技術選択**
- フロントエンド：React + Canvas API + CSS Grid
- 永続化は後回し（LocalStorageで代替検討）

#### 実装開始点の検討
**実装順序（TDD前提）**
1. テスト環境構築（Vitest + Testing Library）
2. 基盤レイアウト（左右分割）
3. お手本表示機能（ファイルアップロード・画像表示・グリッド）
4. 描画機能（Canvas描画・ペン設定）

**理由**
- テスト環境を最初に構築してTDD体制確立
- レイアウトでコンポーネント境界を明確化
- お手本機能でユーザー体験の基礎を構築
- Canvas描画は複雑なため最後に集中

### テスト環境構築完了
- Vitest + React Testing Library + jsdom導入
- 基本テストユーティリティ作成（src/test/test-utils.tsx）
- テストスクリプト追加（test, test:ui, test:run）
- 動作確認完了（2テスト通過）

### 基盤レイアウト実装完了（TDD）
- SplitLayoutコンポーネント作成
  - 左右分割（お手本表示/描画エリア）
  - アクセシビリティ対応（role, aria-label）
  - CSS Grid使用
- ウィンドウフルスクリーン対応
  - body, html, #rootの制約解除
  - 100vw × 100vh完全活用
  - 明るいテーマに変更（描画アプリに適用）
- テスト5件全通過

### お手本表示機能実装完了（TDD）
- ImageUploadコンポーネント（5テスト）
  - ファイル選択・ドラッグ&ドロップ対応
  - 画像ファイル形式検証
- ImageDisplayコンポーネント（6テスト）
  - 画像表示・プレースホルダー表示
  - レスポンシブ対応
- GridOverlayコンポーネント（6テスト）
  - SVGベースグリッド描画
  - サイズ・色・線幅カスタマイズ
- ReferencePanelコンポーネント（7テスト）
  - 上記3コンポーネント統合
  - グリッド設定UI
  - 状態管理（画像・グリッド設定）
- App.tsxに統合完了
- 全30テスト通過

